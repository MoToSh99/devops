{{ template "layout.html" . }}

<h2>
  {{ if eq "timeline" .RequestEndpoint }}
    Public Timeline
  {{ else if eq "user_timeline" .RequestEndpoint }}
    {{ .SessionUser }}'s Timeline
  {{ else }}
    My Timeline
  {{ end }}
 </h2>
  {{ if .IsLoggedIn }} 
    {{ if eq .RequestEndpoint "user_timeline" }}
      <div class=followstatus>
      {{ if eq .SessionUser .UserProfile }}
        This is you!
      {{ else if .Followed }}
        You are currently following this user.
        <a class=unfollow href="/{{.UserProfile}}/unfollow, username=.UserProfile)
          }}">Unfollow user</a>.
      {{ else }}
        You are not yet following this user.
        <a class=follow href="/{{.SessionUser}}/follow, username=.SessionUser)
          }}">Follow user</a>.
      {{ end }}
      </div>
    {{ else if eq .RequestEndpoint "timeline" }}
      <div class=twitbox>
        <h3>What's on your mind {{ .SessionUser }}?</h3>
        <form action="/addMessage" method=post>
          <p><input type=text name=text size=60> 
             <input type=submit value="Share">
        </form>
      </div>
    {{ end }}
  {{ end }}

  <ul class=messages>
    {{ if gt (len .Messages) 0}}
      {{range .Messages}}
        <li>
          {{/* <img src={{.gravatar_url}}> */}}
          <strong>
            {{/*<a href="{{ url_for('user_timeline', username=message.username)}}">{{ message.username }}</a>*/}}
            <a href="">{{ .Username }}</a>
          </strong>
          {{ .Text }}
          <small>&mdash; {{ .Pub_date}}</small>
        </li>
      {{end}}
    {{else}}
    <em>There's no message so far.</em>
    {{end}}
  </ul>

{{ template "footer.html" . }}